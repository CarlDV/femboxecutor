<?xml version="1.0" encoding="utf-8"?>
<Window x:Class="VelocityExecutor.MainWindow" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:d="http://schemas.microsoft.com/expression/blend/2008" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" xmlns:wv2="clr-namespace:Microsoft.Web.WebView2.Wpf;assembly=Microsoft.Web.WebView2.Wpf" xmlns:behaviors="clr-namespace:VelocityExecutor.Behaviors" xmlns:converters="clr-namespace:VelocityExecutor.Converters" Title="Fembox" Height="450" Width="750" WindowStyle="None" AllowsTransparency="True" Background="#00FFFFFF" WindowStartupLocation="CenterScreen" ResizeMode="CanResize" Icon="Images/app_icon.png" UseLayoutRounding="True" SnapsToDevicePixels="True" TextOptions.TextFormattingMode="Display" RenderOptions.BitmapScalingMode="HighQuality" RenderOptions.EdgeMode="Aliased" xmlns:velocityexecutor="clr-namespace:VelocityExecutor">
  <WindowChrome.WindowChrome>
    <WindowChrome CaptionHeight="50" ResizeBorderThickness="6" GlassFrameThickness="0" CornerRadius="0" />
  </WindowChrome.WindowChrome>
  <FrameworkElement.Resources>
    <ResourceDictionary>
      <converters:ScrollProgressConverter x:Key="ScrollProgressConverter" />
      <converters:ScrollOffsetConverter x:Key="ScrollOffsetConverter" />
      <FontFamily x:Key="MonacoFont">Cascadia Code, Fira Code, JetBrains Mono, Consolas, Courier New, monospace</FontFamily>
      <SolidColorBrush x:Key="DarkBg" Color="#0D0D0D" />
      <SolidColorBrush x:Key="TextPrimary" Color="#FFFFFF" />
      <SolidColorBrush x:Key="TextSecondary" Color="#999999" />
      <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter" />
      <Geometry x:Key="IconSettings">M19.14,12.94c0.04-0.3,0.06-0.61,0.06-0.94c0-0.32-0.02-0.64-0.07-0.94l2.03-1.58c0.18-0.14,0.23-0.41,0.12-0.61 l-1.92-3.32c-0.12-0.22-0.37-0.29-0.59-0.22l-2.39,0.96c-0.5-0.38-1.03-0.7-1.62-0.94L14.4,2.81c-0.04-0.24-0.24-0.41-0.48-0.41 h-3.84c-0.24,0-0.43,0.17-0.47,0.41L9.25,5.35C8.66,5.59,8.12,5.92,7.63,6.29L5.24,5.33c-0.22-0.08-0.47,0-0.59,0.22L2.74,8.87 C2.62,9.08,2.66,9.34,2.86,9.48l2.03,1.58C4.84,11.36,4.8,11.69,4.8,12s0.02,0.64,0.07,0.94l-2.03,1.58 c-0.18,0.14-0.23,0.41-0.12,0.61l1.92,3.32c0.12,0.22,0.37,0.29,0.59,0.22l2.39-0.96c0.5,0.38,1.03,0.7,1.62,0.94l0.36,2.54 c0.05,0.24,0.24,0.41,0.48,0.41h3.84c0.24,0,0.43-0.17,0.47-0.41l0.36-2.54c0.59-0.24,1.13-0.56,1.62-0.94l2.39,0.96 c0.22,0.08,0.47,0,0.59-0.22l1.92-3.32c0.12-0.22,0.07-0.47-0.12-0.61L19.14,12.94z M12,15.6c-1.98,0-3.6-1.62-3.6-3.6 s1.62-3.6,3.6-3.6s3.6,1.62,3.6,3.6S13.98,15.6,12,15.6z</Geometry>
      <Geometry x:Key="IconOpen">M19,20H4C2.89,20 2,19.1 2,18V6C2,4.89 2.89,4 4,4H10L12,6H19A2,2 0 0,1 21,8H21L4,8V18L6.14,10H23.21L20.93,18.5C20.7,19.37 19.92,20 19,20Z</Geometry>
      <Geometry x:Key="IconSave">M15,9H5V5H15M12,19A3,3 0 0,1 9,16A3,3 0 0,1 12,13A3,3 0 0,1 15,16A3,3 0 0,1 12,19M17,3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V7L17,3Z</Geometry>
      <Geometry x:Key="IconClear">M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z</Geometry>
      <Geometry x:Key="IconAdd">M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z</Geometry>
      <Geometry x:Key="IconConsole">M20,19V7H4V19H20M20,3A2,2 0 0,1 22,5V19A2,2 0 0,1 20,21H4A2,2 0 0,1 2,19V5C2,3.89 2.89,3 4,3H20M13,17V15H18V17H13M9.58,13L5.57,9H8.4L11,11.6L8.4,14.2H5.57L9.58,13Z</Geometry>
      <Geometry x:Key="IconTrash">M9,3V4H4V6H5V19A2,2 0 0,0 7,21H17A2,2 0 0,0 19,19V6H20V4H15V3H9M7,6H17V19H7V6M9,8V17H11V8H9M13,8V17H15V8H13Z</Geometry>
      <Geometry x:Key="IconFolderOpen">M19,20H4A2,2 0 0,1 2,18V6A2,2 0 0,1 4,4H9L11,6H19A2,2 0 0,1 21,8V20A2,2 0 0,1 19,20M4,8V18H19V8H4Z</Geometry>
      <Geometry x:Key="IconFloppy">M15,9H5V5H15M12,19A3,3 0 0,1 9,16A3,3 0 0,1 12,13A3,3 0 0,1 15,16A3,3 0 0,1 12,19M17,3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V7L17,3Z</Geometry>
      <Geometry x:Key="IconLink">M7,2V13H10V22L17,10H13L17,2H7Z</Geometry>
      <Geometry x:Key="IconPlay">M8,5.14V19.14L19,12.14L8,5.14Z</Geometry>
      <Style x:Key="SlimScrollBar" TargetType="{x:Type ScrollBar}">
        <Setter Property="Stylus.IsFlicksEnabled" Value="False" />
        <Setter Property="Foreground" Value="{DynamicResource AccentColor}" />
        <Setter Property="Background" Value="#00FFFFFF" />
        <Setter Property="Width" Value="1" />
        <Setter Property="Height" Value="1" />
        <Setter Property="Template">
          <Setter.Value>
            <ControlTemplate TargetType="{x:Type ScrollBar}">
              <Grid Name="GridRoot" Background="#00FFFFFF">
                <Track Name="PART_Track" IsDirectionReversed="False" Focusable="False">
                  <Track.Thumb>
                    <Thumb Name="Thumb">
                      <Control.Template>
                        <ControlTemplate TargetType="{x:Type Thumb}">
                          <Border Background="{TemplateBinding Control.Foreground}" CornerRadius="0" />
                        </ControlTemplate>
                      </Control.Template>
                    </Thumb>
                  </Track.Thumb>
                  <Track.IncreaseRepeatButton>
                    <RepeatButton Command="ScrollBar.LineDownCommand" Opacity="0" Focusable="False" />
                  </Track.IncreaseRepeatButton>
                  <Track.DecreaseRepeatButton>
                    <RepeatButton Command="ScrollBar.LineUpCommand" Opacity="0" Focusable="False" />
                  </Track.DecreaseRepeatButton>
                </Track>
              </Grid>
              <ControlTemplate.Triggers>
                <Trigger Property="ScrollBar.Orientation" Value="Horizontal">
                  <Setter Property="Width" Value="Auto" />
                  <Setter Property="Height" Value="1" />
                </Trigger>
                <Trigger Property="UIElement.IsMouseOver" Value="True">
                  <Setter Property="Height" Value="4" />
                </Trigger>
              </ControlTemplate.Triggers>
            </ControlTemplate>
          </Setter.Value>
        </Setter>
      </Style>
      <Style x:Key="TitleButton" TargetType="{x:Type Button}">
        <Setter Property="Background" Value="#00FFFFFF" />
        <Setter Property="Foreground" Value="#FFFFFFFF" />
        <Setter Property="BorderThickness" Value="0" />
        <Setter Property="Padding" Value="10,0" />
        <Setter Property="WindowChrome.IsHitTestVisibleInChrome" Value="True" />
        <Setter Property="RenderOptions.BitmapScalingMode" Value="HighQuality" />
        <Setter Property="Template">
          <Setter.Value>
            <ControlTemplate TargetType="{x:Type Button}">
              <Border Name="border" Background="{TemplateBinding Control.Background}" Padding="{TemplateBinding Control.Padding}">
                <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" />
              </Border>
              <ControlTemplate.Triggers>
                <Trigger Property="UIElement.IsMouseOver" Value="True">
                  <TriggerBase.EnterActions>
                    <BeginStoryboard>
                      <Storyboard>
                        <ColorAnimation Storyboard.TargetName="border" Storyboard.TargetProperty="Background.Color" To="#20FFFFFF" Duration="0:0:0.25">
                          <ColorAnimation.EasingFunction>
                            <QuarticEase EasingMode="EaseOut" />
                          </ColorAnimation.EasingFunction>
                        </ColorAnimation>
                      </Storyboard>
                    </BeginStoryboard>
                  </TriggerBase.EnterActions>
                  <TriggerBase.ExitActions>
                    <BeginStoryboard>
                      <Storyboard>
                        <ColorAnimation Storyboard.TargetName="border" Storyboard.TargetProperty="Background.Color" Duration="0:0:0.15">
                          <ColorAnimation.EasingFunction>
                            <CubicEase EasingMode="EaseOut" />
                          </ColorAnimation.EasingFunction>
                        </ColorAnimation>
                      </Storyboard>
                    </BeginStoryboard>
                  </TriggerBase.ExitActions>
                </Trigger>
              </ControlTemplate.Triggers>
            </ControlTemplate>
          </Setter.Value>
        </Setter>
      </Style>
      <Style x:Key="ActionButton" TargetType="{x:Type Button}">
        <Setter Property="Background" Value="{DynamicResource ActionButtonBackground}" />
        <Setter Property="Foreground" Value="#CCFFFFFF" />
        <Setter Property="BorderThickness" Value="0" />
        <Setter Property="Padding" Value="12" />
        <Setter Property="Margin" Value="0,0,6,0" />
        <Setter Property="Width" Value="44" />
        <Setter Property="Height" Value="44" />
        <Setter Property="RenderOptions.BitmapScalingMode" Value="HighQuality" />
        <Setter Property="Template">
          <Setter.Value>
            <ControlTemplate TargetType="{x:Type Button}">
              <Border Name="border" Background="{TemplateBinding Control.Background}" CornerRadius="8" BorderBrush="#20FFFFFF" BorderThickness="1" Padding="0" RenderTransformOrigin="0.5,0.5">
                <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" />
                <UIElement.RenderTransform>
                  <ScaleTransform x:Name="scaleTransform" ScaleX="1" ScaleY="1" />
                </UIElement.RenderTransform>
              </Border>
              <ControlTemplate.Triggers>
                <Trigger Property="UIElement.IsMouseOver" Value="True">
                  <TriggerBase.EnterActions>
                    <BeginStoryboard>
                      <Storyboard>
                        <ColorAnimation Storyboard.TargetName="border" Storyboard.TargetProperty="Background.Color" To="#15FFFFFF" Duration="0:0:0.15">
                          <ColorAnimation.EasingFunction>
                            <CubicEase EasingMode="EaseOut" />
                          </ColorAnimation.EasingFunction>
                        </ColorAnimation>
                        <ColorAnimation Storyboard.TargetName="border" Storyboard.TargetProperty="BorderBrush.Color" To="#50FFFFFF" Duration="0:0:0.15">
                          <ColorAnimation.EasingFunction>
                            <CubicEase EasingMode="EaseOut" />
                          </ColorAnimation.EasingFunction>
                        </ColorAnimation>
                        <DoubleAnimation Storyboard.TargetName="scaleTransform" Storyboard.TargetProperty="ScaleX" To="1.05" Duration="0:0:0.2">
                          <DoubleAnimation.EasingFunction>
                            <CubicEase EasingMode="EaseOut" />
                          </DoubleAnimation.EasingFunction>
                        </DoubleAnimation>
                        <DoubleAnimation Storyboard.TargetName="scaleTransform" Storyboard.TargetProperty="ScaleY" To="1.05" Duration="0:0:0.2">
                          <DoubleAnimation.EasingFunction>
                            <CubicEase EasingMode="EaseOut" />
                          </DoubleAnimation.EasingFunction>
                        </DoubleAnimation>
                      </Storyboard>
                    </BeginStoryboard>
                  </TriggerBase.EnterActions>
                  <TriggerBase.ExitActions>
                    <BeginStoryboard>
                      <Storyboard>
                        <ColorAnimation Storyboard.TargetName="border" Storyboard.TargetProperty="Background.Color" Duration="0:0:0.15">
                          <ColorAnimation.EasingFunction>
                            <CubicEase EasingMode="EaseOut" />
                          </ColorAnimation.EasingFunction>
                        </ColorAnimation>
                        <ColorAnimation Storyboard.TargetName="border" Storyboard.TargetProperty="BorderBrush.Color" Duration="0:0:0.15">
                          <ColorAnimation.EasingFunction>
                            <CubicEase EasingMode="EaseOut" />
                          </ColorAnimation.EasingFunction>
                        </ColorAnimation>
                        <DoubleAnimation Storyboard.TargetName="scaleTransform" Storyboard.TargetProperty="ScaleX" To="1" Duration="0:0:0.2">
                          <DoubleAnimation.EasingFunction>
                            <CubicEase EasingMode="EaseOut" />
                          </DoubleAnimation.EasingFunction>
                        </DoubleAnimation>
                        <DoubleAnimation Storyboard.TargetName="scaleTransform" Storyboard.TargetProperty="ScaleY" To="1" Duration="0:0:0.2">
                          <DoubleAnimation.EasingFunction>
                            <CubicEase EasingMode="EaseOut" />
                          </DoubleAnimation.EasingFunction>
                        </DoubleAnimation>
                      </Storyboard>
                    </BeginStoryboard>
                  </TriggerBase.ExitActions>
                </Trigger>
                <Trigger Property="IsPressed" Value="True">
                  <TriggerBase.EnterActions>
                    <BeginStoryboard>
                      <Storyboard>
                        <DoubleAnimation Storyboard.TargetName="scaleTransform" Storyboard.TargetProperty="ScaleX" To="0.95" Duration="0:0:0.08">
                          <DoubleAnimation.EasingFunction>
                            <CubicEase EasingMode="EaseOut" />
                          </DoubleAnimation.EasingFunction>
                        </DoubleAnimation>
                        <DoubleAnimation Storyboard.TargetName="scaleTransform" Storyboard.TargetProperty="ScaleY" To="0.95" Duration="0:0:0.08">
                          <DoubleAnimation.EasingFunction>
                            <CubicEase EasingMode="EaseOut" />
                          </DoubleAnimation.EasingFunction>
                        </DoubleAnimation>
                      </Storyboard>
                    </BeginStoryboard>
                  </TriggerBase.EnterActions>
                </Trigger>
              </ControlTemplate.Triggers>
            </ControlTemplate>
          </Setter.Value>
        </Setter>
      </Style>
    </ResourceDictionary>
  </FrameworkElement.Resources>
  <Border Background="#00FFFFFF">
    <UIElement.Effect>
      <DropShadowEffect Color="Black" BlurRadius="30" ShadowDepth="0" Opacity="0.8" />
    </UIElement.Effect>
    <Border Background="{StaticResource DarkBg}" BorderBrush="#2A2A2A" BorderThickness="1">
      <Grid>
        <Grid>
          <Image Name="BackgroundImage" Source="Images/background.png" Stretch="UniformToFill" Opacity="0.4" />
          <Rectangle>
            <Shape.Fill>
              <LinearGradientBrush StartPoint="0.5,0" EndPoint="0.5,1">
                <GradientStop Color="#30000000" Offset="0" />
                <GradientStop Color="#60000000" Offset="1" />
              </LinearGradientBrush>
            </Shape.Fill>
          </Rectangle>
        </Grid>
        <Grid>
          <Grid.RowDefinitions>
            <RowDefinition Height="50" />
            <RowDefinition Height="46" />
            <RowDefinition Height="*" />
            <RowDefinition Height="60" />
          </Grid.RowDefinitions>
          <Border Grid.Row="0" Background="#10000000" BorderBrush="#25FFFFFF" BorderThickness="0,0,0,1">
            <Grid Background="#00FFFFFF" MouseLeftButtonDown="TitleBar_MouseLeftButtonDown">
              <StackPanel Orientation="Horizontal" Margin="16,0,0,0" VerticalAlignment="Center" WindowChrome.IsHitTestVisibleInChrome="True">
                <TextBlock Name="AppTitleText" Text="Fembox" FontSize="26" Foreground="#FFFFFFFF" FontWeight="Bold" FontFamily="{StaticResource MonacoFont}" ToolTip="Click to Rename" VerticalAlignment="Center" Cursor="Hand" MouseLeftButtonDown="RenameTitle_Click" />
                <TextBlock Name="VersionText" Text="" FontSize="10" Foreground="{DynamicResource AccentColor}" FontFamily="{StaticResource MonacoFont}" Margin="8,0,0,0" VerticalAlignment="Center" Visibility="Collapsed" />
                <Ellipse Name="StatusCircle" Width="10" Height="10" Fill="#FF453A" Margin="14,2,0,0" VerticalAlignment="Center">
                  <UIElement.Effect>
                    <DropShadowEffect BlurRadius="8" ShadowDepth="0" Color="#FF453A" x:Name="StatusGlow" />
                  </UIElement.Effect>
                </Ellipse>
              </StackPanel>
              <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,0,4,0">
                <Button Style="{StaticResource TitleButton}" Width="40" Height="50" ToolTip="New Script" Click="AddScript_Click">
                  <Path Data="{StaticResource IconAdd}" Fill="{StaticResource TextSecondary}" Width="14" Height="14" Stretch="Uniform" />
                </Button>
                <Button Style="{StaticResource TitleButton}" Width="40" Height="50" ToolTip="Settings" Click="Settings_Click">
                  <Path Data="{StaticResource IconSettings}" Fill="{StaticResource TextSecondary}" Width="14" Height="14" Stretch="Uniform" />
                </Button>
                <Button Style="{StaticResource TitleButton}" Width="40" Height="50" ToolTip="Toggle Console" Click="ToggleConsole_Click">
                  <Path Data="{StaticResource IconConsole}" Fill="{StaticResource TextSecondary}" Width="14" Height="14" Stretch="Uniform" />
                </Button>
                <Rectangle Width="1" Height="24" Fill="#25FFFFFF" Margin="8,0" />
                <Button Content="—" Style="{StaticResource TitleButton}" Width="46" Height="50" FontSize="14" Click="MinimizeButton_Click" />
                <Button Content="✕" Style="{StaticResource TitleButton}" Width="46" Height="50" FontSize="14" Click="CloseButton_Click" />
              </StackPanel>
            </Grid>
          </Border>
          <Border Grid.Row="1" Background="#08000000" BorderBrush="#20FFFFFF" BorderThickness="0,0,0,1">
            <Grid>
              <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="Auto" />
              </Grid.ColumnDefinitions>
              <Grid.RowDefinitions>
                <RowDefinition Height="*" />
                <RowDefinition Height="Auto" />
              </Grid.RowDefinitions>
              <Button Name="ScrollLeftButton" Grid.Column="0" Grid.Row="0" Width="35" Background="#00FFFFFF" BorderThickness="0" Opacity="0.6" Cursor="Hand" Click="ScrollLeft_Click">
                <Path Data="M15,8 L8,15 L15,22" Stroke="{DynamicResource AccentColor}" StrokeThickness="2" Width="16" Height="16" Stretch="Uniform" />
                <FrameworkElement.Style>
                  <Style TargetType="{x:Type Button}">
                    <Setter Property="Template">
                      <Setter.Value>
                        <ControlTemplate TargetType="{x:Type Button}">
                          <Border Name="border" Background="{TemplateBinding Control.Background}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" />
                          </Border>
                          <ControlTemplate.Triggers>
                            <Trigger Property="UIElement.IsMouseOver" Value="True">
                              <Setter Property="UIElement.Opacity" Value="1" />
                              <Setter TargetName="border" Property="Border.Background" Value="#10FFFFFF" />
                            </Trigger>
                          </ControlTemplate.Triggers>
                        </ControlTemplate>
                      </Setter.Value>
                    </Setter>
                  </Style>
                </FrameworkElement.Style>
              </Button>
              <Button Name="ScrollRightButton" Grid.Column="2" Grid.Row="0" Width="35" Background="#00FFFFFF" BorderThickness="0" Opacity="0.6" Cursor="Hand" Click="ScrollRight_Click">
                <Path Data="M8,8 L15,15 L8,22" Stroke="{DynamicResource AccentColor}" StrokeThickness="2" Width="16" Height="16" Stretch="Uniform" />
                <FrameworkElement.Style>
                  <Style TargetType="{x:Type Button}">
                    <Setter Property="Template">
                      <Setter.Value>
                        <ControlTemplate TargetType="{x:Type Button}">
                          <Border Name="border" Background="{TemplateBinding Control.Background}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" />
                          </Border>
                          <ControlTemplate.Triggers>
                            <Trigger Property="UIElement.IsMouseOver" Value="True">
                              <Setter Property="UIElement.Opacity" Value="1" />
                              <Setter TargetName="border" Property="Border.Background" Value="#10FFFFFF" />
                            </Trigger>
                          </ControlTemplate.Triggers>
                        </ControlTemplate>
                      </Setter.Value>
                    </Setter>
                  </Style>
                </FrameworkElement.Style>
              </Button>
              <ListBox Name="ScriptList" Grid.Column="1" Grid.Row="0" Background="#00FFFFFF" BorderThickness="0" ScrollViewer.HorizontalScrollBarVisibility="Hidden" ScrollViewer.VerticalScrollBarVisibility="Disabled" FontFamily="{StaticResource MonacoFont}" FontSize="13" SelectionChanged="ScriptList_SelectionChanged" PreviewMouseWheel="ScriptList_PreviewMouseWheel">
                <Control.Template>
                  <ControlTemplate TargetType="{x:Type ListBox}">
                    <ScrollViewer Name="ScriptScrollViewer" Focusable="False" Padding="0" PanningMode="HorizontalOnly" PanningDeceleration="0.001" PanningRatio="1.0">
                      <Control.Template>
                        <ControlTemplate TargetType="{x:Type ScrollViewer}">
                          <Grid Background="{TemplateBinding Control.Background}">
                            <Grid.RowDefinitions>
                              <RowDefinition Height="*" />
                            </Grid.RowDefinitions>
                            <ScrollContentPresenter Name="PART_ScrollContentPresenter" Grid.Row="0" CanContentScroll="{TemplateBinding ScrollViewer.CanContentScroll}" />
                          </Grid>
                        </ControlTemplate>
                      </Control.Template>
                      <ItemsPresenter SnapsToDevicePixels="{TemplateBinding UIElement.SnapsToDevicePixels}" />
                    </ScrollViewer>
                  </ControlTemplate>
                </Control.Template>
                <ItemsControl.ItemsPanel>
                  <ItemsPanelTemplate>
                    <StackPanel Orientation="Horizontal" />
                  </ItemsPanelTemplate>
                </ItemsControl.ItemsPanel>
                <ItemsControl.ItemTemplate>
                  <DataTemplate>
                    <Grid Height="32" Width="160">
                      <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="Auto" />
                      </Grid.ColumnDefinitions>
                      <Path Grid.Column="0" Data="{StaticResource IconScript}" Width="12" Height="12" Stretch="Uniform" Margin="12,0,8,0" VerticalAlignment="Center" Opacity="0.7" Fill="{Binding Foreground, RelativeSource={RelativeSource AncestorType=TextBlock}}" />
                      <TextBlock Grid.Column="1" Foreground="#DDDDDD" FontSize="13" VerticalAlignment="Center" FontWeight="Normal" MaxWidth="150" TextTrimming="CharacterEllipsis" Text="{Binding FileName}" />
                      <Button Grid.Column="2" Width="18" Height="18" Margin="8,0,8,0" Background="#00FFFFFF" BorderThickness="0" Padding="0" Tag="{Binding}" Visibility="{Binding IsSelected, Converter={StaticResource BooleanToVisibilityConverter}, RelativeSource={RelativeSource AncestorType=ListBoxItem}}" Click="CloseTabWithWarning_Click">
                        <Control.Template>
                          <ControlTemplate TargetType="{x:Type Button}">
                            <Border Name="DeleteBox" Background="#FF0000" CornerRadius="2" Width="18" Height="18" RenderTransformOrigin="0.5,0.5">
                              <UIElement.RenderTransform>
                                <ScaleTransform x:Name="deleteScale" ScaleX="1" ScaleY="1" />
                              </UIElement.RenderTransform>
                            </Border>
                            <ControlTemplate.Triggers>
                              <Trigger Property="UIElement.IsMouseOver" Value="True">
                                <TriggerBase.EnterActions>
                                  <BeginStoryboard>
                                    <Storyboard>
                                      <DoubleAnimation Storyboard.TargetName="deleteScale" Storyboard.TargetProperty="ScaleX" To="1.15" Duration="0:0:0.15">
                                        <DoubleAnimation.EasingFunction>
                                          <CubicEase EasingMode="EaseOut" />
                                        </DoubleAnimation.EasingFunction>
                                      </DoubleAnimation>
                                      <DoubleAnimation Storyboard.TargetName="deleteScale" Storyboard.TargetProperty="ScaleY" To="1.15" Duration="0:0:0.15">
                                        <DoubleAnimation.EasingFunction>
                                          <CubicEase EasingMode="EaseOut" />
                                        </DoubleAnimation.EasingFunction>
                                      </DoubleAnimation>
                                      <ColorAnimation Storyboard.TargetName="DeleteBox" Storyboard.TargetProperty="Background.Color" To="#CC0000" Duration="0:0:0.15">
                                        <ColorAnimation.EasingFunction>
                                          <CubicEase EasingMode="EaseOut" />
                                        </ColorAnimation.EasingFunction>
                                      </ColorAnimation>
                                    </Storyboard>
                                  </BeginStoryboard>
                                </TriggerBase.EnterActions>
                                <TriggerBase.ExitActions>
                                  <BeginStoryboard>
                                    <Storyboard>
                                      <DoubleAnimation Storyboard.TargetName="deleteScale" Storyboard.TargetProperty="ScaleX" To="1" Duration="0:0:0.15">
                                        <DoubleAnimation.EasingFunction>
                                          <CubicEase EasingMode="EaseOut" />
                                        </DoubleAnimation.EasingFunction>
                                      </DoubleAnimation>
                                      <DoubleAnimation Storyboard.TargetName="deleteScale" Storyboard.TargetProperty="ScaleY" To="1" Duration="0:0:0.15">
                                        <DoubleAnimation.EasingFunction>
                                          <CubicEase EasingMode="EaseOut" />
                                        </DoubleAnimation.EasingFunction>
                                      </DoubleAnimation>
                                      <ColorAnimation Storyboard.TargetName="DeleteBox" Storyboard.TargetProperty="Background.Color" To="#FF0000" Duration="0:0:0.15">
                                        <ColorAnimation.EasingFunction>
                                          <CubicEase EasingMode="EaseOut" />
                                        </ColorAnimation.EasingFunction>
                                      </ColorAnimation>
                                    </Storyboard>
                                  </BeginStoryboard>
                                </TriggerBase.ExitActions>
                              </Trigger>
                              <Trigger Property="ButtonBase.IsPressed" Value="True">
                                <TriggerBase.EnterActions>
                                  <BeginStoryboard>
                                    <Storyboard>
                                      <DoubleAnimation Storyboard.TargetName="deleteScale" Storyboard.TargetProperty="ScaleX" To="0.9" Duration="0:0:0.08">
                                        <DoubleAnimation.EasingFunction>
                                          <CubicEase EasingMode="EaseOut" />
                                        </DoubleAnimation.EasingFunction>
                                      </DoubleAnimation>
                                      <DoubleAnimation Storyboard.TargetName="deleteScale" Storyboard.TargetProperty="ScaleY" To="0.9" Duration="0:0:0.08">
                                        <DoubleAnimation.EasingFunction>
                                          <CubicEase EasingMode="EaseOut" />
                                        </DoubleAnimation.EasingFunction>
                                      </DoubleAnimation>
                                    </Storyboard>
                                  </BeginStoryboard>
                                </TriggerBase.EnterActions>
                              </Trigger>
                            </ControlTemplate.Triggers>
                          </ControlTemplate>
                        </Control.Template>
                      </Button>
                    </Grid>
                    <DataTemplate.Triggers>
                      <DataTrigger Value="True" Binding="{Binding IsSelected, RelativeSource={RelativeSource AncestorType=ListBoxItem}}">
                        <Setter Property="TextBlock.FontWeight" Value="SemiBold" />
                        <Setter Property="TextBlock.Foreground" Value="#FFFFFF" />
                      </DataTrigger>
                    </DataTemplate.Triggers>
                  </DataTemplate>
                </ItemsControl.ItemTemplate>
                <FrameworkElement.Resources>
                  <ResourceDictionary>
                    <ContextMenu x:Key="ItemContextMenu">
                      <MenuItem Header="Rename" Tag="{Binding}" Click="RenameScript_Click" />
                      <Separator />
                      <MenuItem Header="Delete" Tag="{Binding}" Click="CtxDelete_Click" />
                    </ContextMenu>
                  </ResourceDictionary>
                </FrameworkElement.Resources>
                <ItemsControl.ItemContainerStyle>
                  <Style TargetType="{x:Type ListBoxItem}">
                    <Setter Property="FrameworkElement.ContextMenu" Value="{StaticResource ItemContextMenu}" />
                    <Setter Property="Background" Value="#00FFFFFF" />
                    <Setter Property="BorderThickness" Value="0,0,0,1" />
                    <Setter Property="BorderBrush" Value="#00FFFFFF" />
                    <Setter Property="Margin" Value="0,0,2,0" />
                    <Setter Property="Padding" Value="0" />
                    <Setter Property="Template">
                      <Setter.Value>
                        <ControlTemplate TargetType="{x:Type ListBoxItem}">
                          <Border Name="Bd" Background="{TemplateBinding Control.Background}" BorderBrush="{TemplateBinding Control.BorderBrush}" BorderThickness="{TemplateBinding Control.BorderThickness}" CornerRadius="0" Padding="{TemplateBinding Control.Padding}" RenderTransformOrigin="0.5,0.5">
                            <ContentPresenter HorizontalAlignment="Stretch" VerticalAlignment="Stretch" />
                            <UIElement.RenderTransform>
                              <ScaleTransform ScaleX="1" ScaleY="1" />
                            </UIElement.RenderTransform>
                          </Border>
                          <ControlTemplate.Triggers>
                            <Trigger Property="UIElement.IsMouseOver" Value="True">
                              <TriggerBase.EnterActions>
                                <BeginStoryboard>
                                  <Storyboard>
                                    <ColorAnimation Storyboard.TargetName="Bd" Storyboard.TargetProperty="Background.Color" To="#15FFFFFF" Duration="0:0:0.15" />
                                  </Storyboard>
                                </BeginStoryboard>
                              </TriggerBase.EnterActions>
                              <TriggerBase.ExitActions>
                                <BeginStoryboard>
                                  <Storyboard>
                                    <ColorAnimation Storyboard.TargetName="Bd" Storyboard.TargetProperty="Background.Color" Duration="0:0:0.15" />
                                  </Storyboard>
                                </BeginStoryboard>
                              </TriggerBase.ExitActions>
                            </Trigger>
                            <Trigger Property="ListBoxItem.IsSelected" Value="True">
                              <Setter TargetName="Bd" Property="Border.Background" Value="#25FFFFFF" />
                              <Setter TargetName="Bd" Value="{DynamicResource AccentColor}" Property="Border.BorderBrush" />
                            </Trigger>
                          </ControlTemplate.Triggers>
                        </ControlTemplate>
                      </Setter.Value>
                    </Setter>
                  </Style>
                </ItemsControl.ItemContainerStyle>
              </ListBox>
              <Grid Name="BottomScrollIndicator" Column="0" ColumnSpan="3" Row="1" Height="1" Margin="0,3,0,3">
                <Border Background="#15FFFFFF" CornerRadius="0.5" Opacity="0.3" />
                <Border Name="TopProgressBar" HorizontalAlignment="Left" Background="{DynamicResource AccentColor}" CornerRadius="0.5" Opacity="0.8">
                  <UIElement.RenderTransform>
                    <TranslateTransform x:Name="IndicatorTransform" />
                  </UIElement.RenderTransform>
                </Border>
              </Grid>
            </Grid>
          </Border>
          <Rectangle Grid.Row="1" Height="1" VerticalAlignment="Top" Fill="{DynamicResource AccentColor}" Opacity="0.3" />
          <Border Grid.Row="2" Background="#05000000">
            <wv2:WebView2 Name="MonacoEditor" DefaultBackgroundColor="Transparent" />
          </Border>
          <Border Grid.Row="3" Background="#12000000" BorderBrush="#20FFFFFF" BorderThickness="0,1,0,0">
            <Grid>
              <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="*" />
              </Grid.ColumnDefinitions>
              <StackPanel Orientation="Horizontal" VerticalAlignment="Center" Margin="20,0,0,0">
                <TextBlock Name="VersionLabel" Text="v1.0.0" Foreground="#60FFFFFF" FontFamily="{StaticResource MonacoFont}" FontSize="11" FontWeight="SemiBold" />
              </StackPanel>
              <StackPanel Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,0,20,0" VerticalAlignment="Center">
                <Button Name="FetchButton" Style="{StaticResource ActionButton}" ToolTip="Show Script from Loadstring" Click="FetchButton_Click">
                  <Path Data="{StaticResource IconFetch}" Width="18" Height="18" Stretch="Uniform" Fill="{Binding Foreground, RelativeSource={RelativeSource AncestorType=Button}}" />
                </Button>
                <Button Name="HistoryButton" Style="{StaticResource ActionButton}" ToolTip="Script Library &amp; History" Click="OpenHistory_Click">
                  <Path Data="{StaticResource IconScript}" Width="18" Height="18" Stretch="Uniform" Fill="{Binding Foreground, RelativeSource={RelativeSource AncestorType=Button}}" />
                </Button>
                <Button Name="ClearButton" Style="{StaticResource ActionButton}" ToolTip="Clear Editor" Click="ClearButton_Click">
                  <Path Data="{StaticResource IconTrash}" Width="18" Height="18" Stretch="Uniform" Fill="{Binding Foreground, RelativeSource={RelativeSource AncestorType=Button}}" />
                </Button>
                <Button Name="LoadFile" Style="{StaticResource ActionButton}" ToolTip="Open File" Click="LoadFile_Click">
                  <Path Data="{StaticResource IconFolderOpen}" Width="18" Height="18" Stretch="Uniform" Fill="{Binding Foreground, RelativeSource={RelativeSource AncestorType=Button}}" />
                </Button>
                <Button Name="SaveFile" Style="{StaticResource ActionButton}" ToolTip="Save File" Click="SaveFile_Click">
                  <Path Data="{StaticResource IconFloppy}" Width="18" Height="18" Stretch="Uniform" Fill="{Binding Foreground, RelativeSource={RelativeSource AncestorType=Button}}" />
                </Button>
                <Button Name="AttachButton" Style="{StaticResource ActionButton}" ToolTip="Attach to Roblox" Click="AttachButton_Click">
                  <Path Data="{StaticResource IconLink}" Width="18" Height="18" Stretch="Uniform" Fill="{Binding Foreground, RelativeSource={RelativeSource AncestorType=Button}}" />
                </Button>
                <Button Name="ExecuteButton" Margin="12,0,0,0" Background="{DynamicResource AccentColor}" BorderThickness="0" Foreground="#FFFFFFFF" Width="50" Height="44" ToolTip="Execute Script" RenderOptions.BitmapScalingMode="HighQuality" Click="ExecuteButton_Click">
                  <Control.Template>
                    <ControlTemplate TargetType="{x:Type Button}">
                      <Border Name="bdr" Background="{TemplateBinding Control.Background}" CornerRadius="8" RenderTransformOrigin="0.5,0.5">
                        <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" />
                        <UIElement.Effect>
                          <DropShadowEffect x:Name="glow" Color="{DynamicResource AccentColorValue}" BlurRadius="15" ShadowDepth="0" Opacity="0.4" />
                        </UIElement.Effect>
                        <UIElement.RenderTransform>
                          <ScaleTransform x:Name="executeScale" ScaleX="1" ScaleY="1" />
                        </UIElement.RenderTransform>
                      </Border>
                      <ControlTemplate.Triggers>
                        <Trigger Property="UIElement.IsMouseOver" Value="True">
                          <TriggerBase.EnterActions>
                            <BeginStoryboard>
                              <Storyboard>
                                <DoubleAnimation Storyboard.TargetName="bdr" Storyboard.TargetProperty="Opacity" To="0.9" Duration="0:0:0.15">
                                  <DoubleAnimation.EasingFunction>
                                    <CubicEase EasingMode="EaseOut" />
                                  </DoubleAnimation.EasingFunction>
                                </DoubleAnimation>
                                <DoubleAnimation Storyboard.TargetName="executeScale" Storyboard.TargetProperty="ScaleX" To="1.08" Duration="0:0:0.2">
                                  <DoubleAnimation.EasingFunction>
                                    <CubicEase EasingMode="EaseOut" />
                                  </DoubleAnimation.EasingFunction>
                                </DoubleAnimation>
                                <DoubleAnimation Storyboard.TargetName="executeScale" Storyboard.TargetProperty="ScaleY" To="1.08" Duration="0:0:0.2">
                                  <DoubleAnimation.EasingFunction>
                                    <CubicEase EasingMode="EaseOut" />
                                  </DoubleAnimation.EasingFunction>
                                </DoubleAnimation>
                                <DoubleAnimation Storyboard.TargetName="glow" Storyboard.TargetProperty="Opacity" To="0.7" Duration="0:0:0.2">
                                  <DoubleAnimation.EasingFunction>
                                    <CubicEase EasingMode="EaseOut" />
                                  </DoubleAnimation.EasingFunction>
                                </DoubleAnimation>
                              </Storyboard>
                            </BeginStoryboard>
                          </TriggerBase.EnterActions>
                          <TriggerBase.ExitActions>
                            <BeginStoryboard>
                              <Storyboard>
                                <DoubleAnimation Storyboard.TargetName="bdr" Storyboard.TargetProperty="Opacity" To="1" Duration="0:0:0.15">
                                  <DoubleAnimation.EasingFunction>
                                    <CubicEase EasingMode="EaseOut" />
                                  </DoubleAnimation.EasingFunction>
                                </DoubleAnimation>
                                <DoubleAnimation Storyboard.TargetName="executeScale" Storyboard.TargetProperty="ScaleX" To="1" Duration="0:0:0.2">
                                  <DoubleAnimation.EasingFunction>
                                    <CubicEase EasingMode="EaseOut" />
                                  </DoubleAnimation.EasingFunction>
                                </DoubleAnimation>
                                <DoubleAnimation Storyboard.TargetName="executeScale" Storyboard.TargetProperty="ScaleY" To="1" Duration="0:0:0.2">
                                  <DoubleAnimation.EasingFunction>
                                    <CubicEase EasingMode="EaseOut" />
                                  </DoubleAnimation.EasingFunction>
                                </DoubleAnimation>
                                <DoubleAnimation Storyboard.TargetName="glow" Storyboard.TargetProperty="Opacity" To="0.4" Duration="0:0:0.2">
                                  <DoubleAnimation.EasingFunction>
                                    <CubicEase EasingMode="EaseOut" />
                                  </DoubleAnimation.EasingFunction>
                                </DoubleAnimation>
                              </Storyboard>
                            </BeginStoryboard>
                          </TriggerBase.ExitActions>
                        </Trigger>
                        <Trigger Property="ButtonBase.IsPressed" Value="True">
                          <TriggerBase.EnterActions>
                            <BeginStoryboard>
                              <Storyboard>
                                <DoubleAnimation Storyboard.TargetName="executeScale" Storyboard.TargetProperty="ScaleX" To="0.96" Duration="0:0:0.08">
                                  <DoubleAnimation.EasingFunction>
                                    <CubicEase EasingMode="EaseOut" />
                                  </DoubleAnimation.EasingFunction>
                                </DoubleAnimation>
                                <DoubleAnimation Storyboard.TargetName="executeScale" Storyboard.TargetProperty="ScaleY" To="0.96" Duration="0:0:0.08">
                                  <DoubleAnimation.EasingFunction>
                                    <CubicEase EasingMode="EaseOut" />
                                  </DoubleAnimation.EasingFunction>
                                </DoubleAnimation>
                              </Storyboard>
                            </BeginStoryboard>
                          </TriggerBase.EnterActions>
                        </Trigger>
                      </ControlTemplate.Triggers>
                    </ControlTemplate>
                  </Control.Template>
                  <Path Data="{StaticResource IconPlay}" Fill="#FFFFFFFF" Width="16" Height="16" Stretch="Uniform" Margin="2,0,0,0" />
                </Button>
              </StackPanel>
            </Grid>
          </Border>
        </Grid>
        <Grid Name="SplashContainer" Visibility="Collapsed">
          <TextBlock Name="SplashSub" />
          <TextBlock Name="L1" />
          <TextBlock Name="L2" />
          <TextBlock Name="L3" />
          <TextBlock Name="L4" />
          <TextBlock Name="L5" />
          <TextBlock Name="L6" />
          <Border Name="SidebarBorder" Visibility="Collapsed" />
          <TextBlock Name="EditorStatusText" Visibility="Collapsed" />
        </Grid>
      </Grid>
    </Border>
  </Border>
</Window>